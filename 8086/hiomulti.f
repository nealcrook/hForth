\ IBM-PCµA¨· ≥aìe hForth ∂w –eãi ∑≥¬âùb œaù°ãaúë∑≥ì°îa. ª°ãq∑e π°–s—w
\ –eãi†e ≥i ÆÅ ∑∂∑sì°îa.
\
\ ∑° œaù°ãaúë∑e VGA ãaúÅœ¢ ƒaóaµ¡ –·«IùAØa ãaúÅœ¢ ƒaóa†e∑i ª°∂•–sì°îa.
\
\ 'TEXT'úaâ° Ø°≈a°e …BØaÀa —¡°e∑aù° §aé·â° 'HGRAPHIC'∑°úaâ° Ø°«°°e ãaúÅœ¢
\ —¡°e∑aù° §aé·¥·¨· –eãi∑i —¡°eµA ŒaØ°–i ÆÅ ∑∂∑sì°îa.
\
\ ¿·∑qµAìe ñÅ§ÈØ¢ ∏aÃe∑aù° ¨È∏˜ñA¥· ∑∂∑sì°îa. 3§ÈØ¢ ∏aÃe∑aù° §aéÅùa°e
\ '3BUL'∑°úaâ° Ø°«°â° 2§ÈØ¢ ∏aÃe∑aù° §aéÅùa°e '2BUL'∑°úaâ° Ø°«°Ø≥Ø°µ°.
\
\ HF86EXE.EXEüi Ø°∏b–e “Å îa∑q ÆÖ¨·ù° ∑° œaù°ãaúë∑i µ©ü© ÆÅ ∑∂∑sì°îa.
\
\	<< OPTIONAL.F
\	<< ASM8086.F
\	<< COREEXT.F
\	<< MSDOS.F
\	BL PARSE MULTI.F    INCLUDED
\	BL PARSE HIOMULTI.F INCLUDED
\
\ 1996. 2. 9.
\ Wonyong Koh
\
\ Usage:
\   TEXT  ( -- )
\	Set text screen and redirect i/o vectors to DOS functions.
\   HGRAPHIC  ( -- )
\	Set graphics screen and redirect i/o vectors to handle Korean
\	character input and graphics screen output.

CHAR " PARSE FILE" ENVIRONMENT? 0= [IF] 0 [THEN]
0= [IF]
    CR .( This program needs FILE wordset words.) ABORT
[THEN]

BASE @
GET-ORDER  GET-CURRENT

FORTH-WORDLIST SET-CURRENT
WORDLIST WORDLIST-NAME –eãi∑≥¬âùb-WORDLIST
–eãi∑≥¬âùb-WORDLIST SET-CURRENT
GET-ORDER –eãi∑≥¬âùb-WORDLIST SWAP 1+ SET-ORDER

CR .( Loading English fonts)
HEX
CREATE ENGFONT	    \ 8x16, 256 ∏a
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ 00h
00000 , 0817E , 081A5 , 0BD81 , 08199 , 07E81 , 00000 , 00000 , \
00000 , 0FF7E , 0FFDB , 0C3FF , 0FFE7 , 07EFF , 00000 , 00000 , \
00000 , 00000 , 0FE6C , 0FEFE , 07CFE , 01038 , 00000 , 00000 , \
00000 , 00000 , 03810 , 0FE7C , 0387C , 00010 , 00000 , 00000 , \
00000 , 01800 , 03C3C , 0E7E7 , 018E7 , 03C18 , 00000 , 00000 , \
00000 , 01800 , 07E3C , 0FFFF , 0187E , 03C18 , 00000 , 00000 , \
00000 , 00000 , 00000 , 03C18 , 0183C , 00000 , 00000 , 00000 , \
0FFFF , 0FFFF , 0FFFF , 0C3E7 , 0E7C3 , 0FFFF , 0FFFF , 0FFFF , \
00000 , 00000 , 03C00 , 04266 , 06642 , 0003C , 00000 , 00000 , \ ^I = TAB
0FFFF , 0FFFF , 0C3FF , 0BD99 , 099BD , 0FFC3 , 0FFFF , 0FFFF , \ ^J = LF
00000 , 00E1E , 0321A , 0CC78 , 0CCCC , 078CC , 00000 , 00000 , \
00000 , 0663C , 06666 , 03C66 , 07E18 , 01818 , 00000 , 00000 , \
00000 , 0333F , 0303F , 03030 , 07030 , 0E0F0 , 00000 , 00000 , \ ^M = CR
00000 , 0637F , 0637F , 06363 , 06763 , 0E6E7 , 000C0 , 00000 , \
00000 , 01800 , 0DB18 , 0E73C , 0DB3C , 01818 , 00000 , 00000 , \
08000 , 0E0C0 , 0F8F0 , 0F8FE , 0E0F0 , 080C0 , 00000 , 00000 , \
00200 , 00E06 , 03E1E , 03EFE , 00E1E , 00206 , 00000 , 00000 , \
00000 , 03C18 , 0187E , 01818 , 03C7E , 00018 , 00000 , 00000 , \
00000 , 06666 , 06666 , 06666 , 00066 , 06666 , 00000 , 00000 , \
00000 , 0DB7F , 0DBDB , 01B7B , 01B1B , 01B1B , 00000 , 00000 , \
07C00 , 060C6 , 06C38 , 0C6C6 , 0386C , 0C60C , 0007C , 00000 , \
00000 , 00000 , 00000 , 00000 , 0FEFE , 0FEFE , 00000 , 00000 , \
00000 , 03C18 , 0187E , 01818 , 03C7E , 07E18 , 00000 , 00000 , \
00000 , 03C18 , 0187E , 01818 , 01818 , 01818 , 00000 , 00000 , \
00000 , 01818 , 01818 , 01818 , 07E18 , 0183C , 00000 , 00000 , \
00000 , 00000 , 01800 , 0FE0C , 0180C , 00000 , 00000 , 00000 , \
00000 , 00000 , 03000 , 0FE60 , 03060 , 00000 , 00000 , 00000 , \
00000 , 00000 , 00000 , 0C0C0 , 0FEC0 , 00000 , 00000 , 00000 , \
00000 , 00000 , 02800 , 0FE6C , 0286C , 00000 , 00000 , 00000 , \
00000 , 00000 , 03810 , 07C38 , 0FE7C , 000FE , 00000 , 00000 , \
00000 , 00000 , 0FEFE , 07C7C , 03838 , 00010 , 00000 , 00000 , \
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ space
00000 , 03C18 , 03C3C , 01818 , 00018 , 01818 , 00000 , 00000 , \ !
06600 , 06666 , 00024 , 00000 , 00000 , 00000 , 00000 , 00000 , \ "
00000 , 06C00 , 0FE6C , 06C6C , 0FE6C , 06C6C , 00000 , 00000 , \ #
01818 , 0C67C , 0C0C2 , 0067C , 08606 , 07CC6 , 01818 , 00000 , \ $
00000 , 00000 , 0C6C2 , 0180C , 06030 , 086C6 , 00000 , 00000 , \ %
00000 , 06C38 , 0386C , 0DC76 , 0CCCC , 076CC , 00000 , 00000 , \ &
03000 , 03030 , 00060 , 00000 , 00000 , 00000 , 00000 , 00000 , \ '
00000 , 0180C , 03030 , 03030 , 03030 , 00C18 , 00000 , 00000 , \ (
00000 , 01830 , 00C0C , 00C0C , 00C0C , 03018 , 00000 , 00000 , \ )
00000 , 00000 , 06600 , 0FF3C , 0663C , 00000 , 00000 , 00000 , \ *
00000 , 00000 , 01800 , 07E18 , 01818 , 00000 , 00000 , 00000 , \ +
00000 , 00000 , 00000 , 00000 , 01800 , 01818 , 00030 , 00000 , \ ,
00000 , 00000 , 00000 , 0FE00 , 00000 , 00000 , 00000 , 00000 , \ -
00000 , 00000 , 00000 , 00000 , 00000 , 01818 , 00000 , 00000 , \ .
00000 , 00000 , 00602 , 0180C , 06030 , 080C0 , 00000 , 00000 , \ /
00000 , 06C38 , 0C6C6 , 0D6D6 , 0C6C6 , 0386C , 00000 , 00000 , \ 0
00000 , 03818 , 01878 , 01818 , 01818 , 07E18 , 00000 , 00000 , \ 1
00000 , 0C67C , 00C06 , 03018 , 0C060 , 0FEC6 , 00000 , 00000 , \ 2
00000 , 0C67C , 00606 , 0063C , 00606 , 07CC6 , 00000 , 00000 , \ 3
00000 , 01C0C , 06C3C , 0FECC , 00C0C , 01E0C , 00000 , 00000 , \ 4
00000 , 0C0FE , 0C0C0 , 006FC , 00606 , 07CC6 , 00000 , 00000 , \ 5
00000 , 06038 , 0C0C0 , 0C6FC , 0C6C6 , 07CC6 , 00000 , 00000 , \ 6
00000 , 0C6FE , 00606 , 0180C , 03030 , 03030 , 00000 , 00000 , \ 7
00000 , 0C67C , 0C6C6 , 0C67C , 0C6C6 , 07CC6 , 00000 , 00000 , \ 8
00000 , 0C67C , 0C6C6 , 0067E , 00606 , 0780C , 00000 , 00000 , \ 9
00000 , 00000 , 01818 , 00000 , 01800 , 00018 , 00000 , 00000 , \ :
00000 , 00000 , 01818 , 00000 , 01800 , 03018 , 00000 , 00000 , \ ;
00000 , 00600 , 0180C , 06030 , 01830 , 0060C , 00000 , 00000 , \ <
00000 , 00000 , 07E00 , 00000 , 0007E , 00000 , 00000 , 00000 , \ =
00000 , 06000 , 01830 , 0060C , 0180C , 06030 , 00000 , 00000 , \ >
00000 , 0C67C , 00CC6 , 01818 , 00018 , 01818 , 00000 , 00000 , \ ?
00000 , 07C00 , 0C6C6 , 0DEDE , 0DCDE , 07CC0 , 00000 , 00000 , \ @
00000 , 03810 , 0C66C , 0FEC6 , 0C6C6 , 0C6C6 , 00000 , 00000 , \ A
00000 , 066FC , 06666 , 0667C , 06666 , 0FC66 , 00000 , 00000 , \ B
00000 , 0663C , 0C0C2 , 0C0C0 , 0C2C0 , 03C66 , 00000 , 00000 , \ C
00000 , 06CF8 , 06666 , 06666 , 06666 , 0F86C , 00000 , 00000 , \ D
00000 , 066FE , 06862 , 06878 , 06260 , 0FE66 , 00000 , 00000 , \ E
00000 , 066FE , 06862 , 06878 , 06060 , 0F060 , 00000 , 00000 , \ F
00000 , 0663C , 0C0C2 , 0DEC0 , 0C6C6 , 03A66 , 00000 , 00000 , \ G
00000 , 0C6C6 , 0C6C6 , 0C6FE , 0C6C6 , 0C6C6 , 00000 , 00000 , \ H
00000 , 0183C , 01818 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ I
00000 , 00C1E , 00C0C , 00C0C , 0CCCC , 078CC , 00000 , 00000 , \ J
00000 , 066E6 , 06C66 , 07878 , 0666C , 0E666 , 00000 , 00000 , \ K
00000 , 060F0 , 06060 , 06060 , 06260 , 0FE66 , 00000 , 00000 , \ L
00000 , 0EEC6 , 0FEFE , 0C6D6 , 0C6C6 , 0C6C6 , 00000 , 00000 , \ M
00000 , 0E6C6 , 0FEF6 , 0CEDE , 0C6C6 , 0C6C6 , 00000 , 00000 , \ N
00000 , 0C67C , 0C6C6 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ O
00000 , 066FC , 06666 , 0607C , 06060 , 0F060 , 00000 , 00000 , \ P
00000 , 0C67C , 0C6C6 , 0C6C6 , 0D6C6 , 07CDE , 00E0C , 00000 , \ Q
00000 , 066FC , 06666 , 06C7C , 06666 , 0E666 , 00000 , 00000 , \ R
00000 , 0C67C , 060C6 , 00C38 , 0C606 , 07CC6 , 00000 , 00000 , \ S
00000 , 07E7E , 0185A , 01818 , 01818 , 03C18 , 00000 , 00000 , \ T
00000 , 0C6C6 , 0C6C6 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ U
00000 , 0C6C6 , 0C6C6 , 0C6C6 , 06CC6 , 01038 , 00000 , 00000 , \ V
00000 , 0C6C6 , 0C6C6 , 0D6D6 , 0FED6 , 06CEE , 00000 , 00000 , \ W
00000 , 0C6C6 , 07C6C , 03838 , 06C7C , 0C6C6 , 00000 , 00000 , \ X
00000 , 06666 , 06666 , 0183C , 01818 , 03C18 , 00000 , 00000 , \ Y
00000 , 0C6FE , 00C86 , 03018 , 0C260 , 0FEC6 , 00000 , 00000 , \ Z
00000 , 0303C , 03030 , 03030 , 03030 , 03C30 , 00000 , 00000 , \ [
00000 , 08000 , 0E0C0 , 03870 , 00E1C , 00206 , 00000 , 00000 , \ /
00000 , 00C3C , 00C0C , 00C0C , 00C0C , 03C0C , 00000 , 00000 , \ ]
03810 , 0C66C , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ^
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 0FF00 , 00000 , \ _
03030 , 00018 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ `
00000 , 00000 , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ a
00000 , 060E0 , 07860 , 0666C , 06666 , 07C66 , 00000 , 00000 , \ b
00000 , 00000 , 07C00 , 0C0C6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ c
00000 , 00C1C , 03C0C , 0CC6C , 0CCCC , 076CC , 00000 , 00000 , \ d
00000 , 00000 , 07C00 , 0FEC6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ e
00000 , 06C38 , 06064 , 060F0 , 06060 , 0F060 , 00000 , 00000 , \ f
00000 , 00000 , 07600 , 0CCCC , 0CCCC , 07CCC , 0CC0C , 00078 , \ g
00000 , 060E0 , 06C60 , 06676 , 06666 , 0E666 , 00000 , 00000 , \ h
00000 , 01818 , 03800 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ i
00000 , 00606 , 00E00 , 00606 , 00606 , 00606 , 06666 , 0003C , \ j
00000 , 060E0 , 06660 , 0786C , 06C78 , 0E666 , 00000 , 00000 , \ k
00000 , 01838 , 01818 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ l
00000 , 00000 , 0EC00 , 0D6FE , 0D6D6 , 0C6D6 , 00000 , 00000 , \ m
00000 , 00000 , 0DC00 , 06666 , 06666 , 06666 , 00000 , 00000 , \ n
00000 , 00000 , 07C00 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ o
00000 , 00000 , 0DC00 , 06666 , 06666 , 07C66 , 06060 , 000F0 , \ p
00000 , 00000 , 07600 , 0CCCC , 0CCCC , 07CCC , 00C0C , 0001E , \ q
00000 , 00000 , 0DC00 , 06676 , 06060 , 0F060 , 00000 , 00000 , \ r
00000 , 00000 , 07C00 , 060C6 , 00C38 , 07CC6 , 00000 , 00000 , \ s
00000 , 03010 , 0FC30 , 03030 , 03030 , 01C36 , 00000 , 00000 , \ t
00000 , 00000 , 0CC00 , 0CCCC , 0CCCC , 076CC , 00000 , 00000 , \ u
00000 , 00000 , 06600 , 06666 , 06666 , 0183C , 00000 , 00000 , \ v
00000 , 00000 , 0C600 , 0D6C6 , 0D6D6 , 06CFE , 00000 , 00000 , \ w
00000 , 00000 , 0C600 , 0386C , 03838 , 0C66C , 00000 , 00000 , \ x
00000 , 00000 , 0C600 , 0C6C6 , 0C6C6 , 07EC6 , 00C06 , 000F8 , \ y
00000 , 00000 , 0FE00 , 018CC , 06030 , 0FEC6 , 00000 , 00000 , \ z
00000 , 0180E , 01818 , 01870 , 01818 , 00E18 , 00000 , 00000 , \ {
00000 , 01818 , 01818 , 00000 , 01818 , 01818 , 00000 , 00000 , \ |
00000 , 01870 , 01818 , 0180E , 01818 , 07018 , 00000 , 00000 , \ }
00000 , 0DC76 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ~
00000 , 00000 , 03810 , 0C66C , 0C6C6 , 000FE , 00000 , 00000 , \ 
\ 00000 , 0663C , 0C0C2 , 0C0C0 , 066C2 , 00C3C , 07C06 , 00000 , \ Ä
\ 00000 , 000CC , 0CC00 , 0CCCC , 0CCCC , 076CC , 00000 , 00000 , \ Å
\ 00C00 , 03018 , 07C00 , 0FEC6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ Ç
\ 01000 , 06C38 , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ É
\ 00000 , 000CC , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ Ñ
\ 06000 , 01830 , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ Ö
\ 03800 , 0386C , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ Ü
\ 00000 , 00000 , 0663C , 06060 , 03C66 , 0060C , 0003C , 00000 , \ á
\ 01000 , 06C38 , 07C00 , 0FEC6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ à
\ 00000 , 000C6 , 07C00 , 0FEC6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ â
\ 06000 , 01830 , 07C00 , 0FEC6 , 0C0C0 , 07CC6 , 00000 , 00000 , \ ä
\ 00000 , 00066 , 03800 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ ã
\ 01800 , 0663C , 03800 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ å
\ 06000 , 01830 , 03800 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ ç
\ 0C600 , 01000 , 06C38 , 0C6C6 , 0C6FE , 0C6C6 , 00000 , 00000 , \ é
\ 06C38 , 00038 , 06C38 , 0C6C6 , 0C6FE , 0C6C6 , 00000 , 00000 , \ è
\ 03018 , 00060 , 066FE , 07C60 , 06060 , 0FE66 , 00000 , 00000 , \ ê
\ 00000 , 00000 , 0CC00 , 03676 , 0D87E , 06ED8 , 00000 , 00000 , \ ë
\ 00000 , 06C3E , 0CCCC , 0CCFE , 0CCCC , 0CECC , 00000 , 00000 , \ í
\ 01000 , 06C38 , 07C00 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ ì
\ 00000 , 000C6 , 07C00 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ î
\ 06000 , 01830 , 07C00 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ ï
\ 03000 , 0CC78 , 0CC00 , 0CCCC , 0CCCC , 076CC , 00000 , 00000 , \ ñ
\ 06000 , 01830 , 0CC00 , 0CCCC , 0CCCC , 076CC , 00000 , 00000 , \ ó
\ 00000 , 000C6 , 0C600 , 0C6C6 , 0C6C6 , 07EC6 , 00C06 , 00078 , \ ò
\ 0C600 , 07C00 , 0C6C6 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ ô
\ 0C600 , 0C600 , 0C6C6 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ ö
\ 01800 , 03C18 , 06066 , 06060 , 03C66 , 01818 , 00000 , 00000 , \ õ
\ 03800 , 0646C , 0F060 , 06060 , 06060 , 0FCE6 , 00000 , 00000 , \ ú
\ 00000 , 06666 , 0183C , 0187E , 0187E , 01818 , 00000 , 00000 , \ ù
\ 0F800 , 0CCCC , 0C4F8 , 0DECC , 0CCCC , 0C6CC , 00000 , 00000 , \ û
\ 00E00 , 0181B , 01818 , 0187E , 01818 , 01818 , 070D8 , 00000 , \ ü
\ 01800 , 06030 , 07800 , 07C0C , 0CCCC , 076CC , 00000 , 00000 , \ †
\ 00C00 , 03018 , 03800 , 01818 , 01818 , 03C18 , 00000 , 00000 , \ °
\ 01800 , 06030 , 07C00 , 0C6C6 , 0C6C6 , 07CC6 , 00000 , 00000 , \ ¢
\ 01800 , 06030 , 0CC00 , 0CCCC , 0CCCC , 076CC , 00000 , 00000 , \ £
\ 00000 , 0DC76 , 0DC00 , 06666 , 06666 , 06666 , 00000 , 00000 , \ §
\ 0DC76 , 0C600 , 0F6E6 , 0DEFE , 0C6CE , 0C6C6 , 00000 , 00000 , \ •
\ 03C00 , 06C6C , 0003E , 0007E , 00000 , 00000 , 00000 , 00000 , \ ¶
\ 03800 , 06C6C , 00038 , 0007C , 00000 , 00000 , 00000 , 00000 , \ ß
\ 00000 , 03030 , 03000 , 06030 , 0C6C0 , 07CC6 , 00000 , 00000 , \ ®
\ 00000 , 00000 , 00000 , 0C0FE , 0C0C0 , 000C0 , 00000 , 00000 , \ ©
\ 00000 , 00000 , 00000 , 006FE , 00606 , 00006 , 00000 , 00000 , \ ™
\ 0C000 , 0C2C0 , 0CCC6 , 03018 , 0DC60 , 00C86 , 03E18 , 00000 , \ ´
\ 0C000 , 0C2C0 , 0CCC6 , 03018 , 0CE66 , 03E9E , 00606 , 00000 , \ ¨
\ 00000 , 01818 , 01800 , 01818 , 03C3C , 0183C , 00000 , 00000 , \ ≠
\ 00000 , 00000 , 03600 , 0D86C , 0366C , 00000 , 00000 , 00000 , \ Æ
\ 00000 , 00000 , 0D800 , 0366C , 0D86C , 00000 , 00000 , 00000 , \ Ø
\ 04411 , 04411 , 04411 , 04411 , 04411 , 04411 , 04411 , 04411 , \ ∞
\ 0AA55 , 0AA55 , 0AA55 , 0AA55 , 0AA55 , 0AA55 , 0AA55 , 0AA55 , \ ±
\ 077DD , 077DD , 077DD , 077DD , 077DD , 077DD , 077DD , 077DD , \ ≤
\ 01818 , 01818 , 01818 , 01818 , 01818 , 01818 , 01818 , 01818 , \ ≥
\ 01818 , 01818 , 01818 , 0F818 , 01818 , 01818 , 01818 , 01818 , \ ¥
\ 01818 , 01818 , 0F818 , 0F818 , 01818 , 01818 , 01818 , 01818 , \ µ
\ 03636 , 03636 , 03636 , 0F636 , 03636 , 03636 , 03636 , 03636 , \ ∂
\ 00000 , 00000 , 00000 , 0FE00 , 03636 , 03636 , 03636 , 03636 , \ ∑
\ 00000 , 00000 , 0F800 , 0F818 , 01818 , 01818 , 01818 , 01818 , \ ∏
\ 03636 , 03636 , 0F636 , 0F606 , 03636 , 03636 , 03636 , 03636 , \ π
\ 03636 , 03636 , 03636 , 03636 , 03636 , 03636 , 03636 , 03636 , \ ∫
\ 00000 , 00000 , 0FE00 , 0F606 , 03636 , 03636 , 03636 , 03636 , \ ª
\ 03636 , 03636 , 0F636 , 0FE06 , 00000 , 00000 , 00000 , 00000 , \ º
\ 03636 , 03636 , 03636 , 0FE36 , 00000 , 00000 , 00000 , 00000 , \ Ω
\ 01818 , 01818 , 0F818 , 0F818 , 00000 , 00000 , 00000 , 00000 , \ æ
\ 00000 , 00000 , 00000 , 0F800 , 01818 , 01818 , 01818 , 01818 , \ ø
\ 01818 , 01818 , 01818 , 01F18 , 00000 , 00000 , 00000 , 00000 , \ ¿
\ 01818 , 01818 , 01818 , 0FF18 , 00000 , 00000 , 00000 , 00000 , \ ¡
\ 00000 , 00000 , 00000 , 0FF00 , 01818 , 01818 , 01818 , 01818 , \ ¬
\ 01818 , 01818 , 01818 , 01F18 , 01818 , 01818 , 01818 , 01818 , \ √
\ 00000 , 00000 , 00000 , 0FF00 , 00000 , 00000 , 00000 , 00000 , \ ƒ
\ 01818 , 01818 , 01818 , 0FF18 , 01818 , 01818 , 01818 , 01818 , \ ≈
\ 01818 , 01818 , 01F18 , 01F18 , 01818 , 01818 , 01818 , 01818 , \ ∆
\ 03636 , 03636 , 03636 , 03736 , 03636 , 03636 , 03636 , 03636 , \ «
\ 03636 , 03636 , 03736 , 03F30 , 00000 , 00000 , 00000 , 00000 , \ »
\ 00000 , 00000 , 03F00 , 03730 , 03636 , 03636 , 03636 , 03636 , \ …
\ 03636 , 03636 , 0F736 , 0FF00 , 00000 , 00000 , 00000 , 00000 , \  
\ 00000 , 00000 , 0FF00 , 0F700 , 03636 , 03636 , 03636 , 03636 , \ À
\ 03636 , 03636 , 03736 , 03730 , 03636 , 03636 , 03636 , 03636 , \ Ã
\ 00000 , 00000 , 0FF00 , 0FF00 , 00000 , 00000 , 00000 , 00000 , \ Õ
\ 03636 , 03636 , 0F736 , 0F700 , 03636 , 03636 , 03636 , 03636 , \ Œ
\ 01818 , 01818 , 0FF18 , 0FF00 , 00000 , 00000 , 00000 , 00000 , \ œ
\ 03636 , 03636 , 03636 , 0FF36 , 00000 , 00000 , 00000 , 00000 , \ –
\ 00000 , 00000 , 0FF00 , 0FF00 , 01818 , 01818 , 01818 , 01818 , \ —
\ 00000 , 00000 , 00000 , 0FF00 , 03636 , 03636 , 03636 , 03636 , \ “
\ 03636 , 03636 , 03636 , 03F36 , 00000 , 00000 , 00000 , 00000 , \ ”
\ 01818 , 01818 , 01F18 , 01F18 , 00000 , 00000 , 00000 , 00000 , \ ‘
\ 00000 , 00000 , 01F00 , 01F18 , 01818 , 01818 , 01818 , 01818 , \ ’
\ 00000 , 00000 , 00000 , 03F00 , 03636 , 03636 , 03636 , 03636 , \ ÷
\ 03636 , 03636 , 03636 , 0FF36 , 03636 , 03636 , 03636 , 03636 , \ ◊
\ 01818 , 01818 , 0FF18 , 0FF18 , 01818 , 01818 , 01818 , 01818 , \ ÿ
\ 01818 , 01818 , 01818 , 0F818 , 00000 , 00000 , 00000 , 00000 , \ Ÿ
\ 00000 , 00000 , 00000 , 01F00 , 01818 , 01818 , 01818 , 01818 , \ ⁄
\ 0FFFF , 0FFFF , 0FFFF , 0FFFF , 0FFFF , 0FFFF , 0FFFF , 0FFFF , \ €
\ 00000 , 00000 , 00000 , 0FF00 , 0FFFF , 0FFFF , 0FFFF , 0FFFF , \ ‹
\ 0F0F0 , 0F0F0 , 0F0F0 , 0F0F0 , 0F0F0 , 0F0F0 , 0F0F0 , 0F0F0 , \ ›
\ 00F0F , 00F0F , 00F0F , 00F0F , 00F0F , 00F0F , 00F0F , 00F0F , \ ﬁ
\ 0FFFF , 0FFFF , 0FFFF , 000FF , 00000 , 00000 , 00000 , 00000 , \ ﬂ
\ 00000 , 00000 , 07600 , 0D8DC , 0D8D8 , 076DC , 00000 , 00000 , \ ‡
\ 00000 , 0CC78 , 0CCCC , 0CCD8 , 0C6C6 , 0CCC6 , 00000 , 00000 , \ ·
\ 00000 , 0C6FE , 0C0C6 , 0C0C0 , 0C0C0 , 0C0C0 , 00000 , 00000 , \ ‚
\ 00000 , 00000 , 06CFE , 06C6C , 06C6C , 06C6C , 00000 , 00000 , \ „
\ 00000 , 0FE00 , 060C6 , 01830 , 06030 , 0FEC6 , 00000 , 00000 , \ ‰
\ 00000 , 00000 , 07E00 , 0D8D8 , 0D8D8 , 070D8 , 00000 , 00000 , \ Â
\ 00000 , 00000 , 06666 , 06666 , 07C66 , 06060 , 000C0 , 00000 , \ Ê
\ 00000 , 00000 , 0DC76 , 01818 , 01818 , 01818 , 00000 , 00000 , \ Á
\ 00000 , 07E00 , 03C18 , 06666 , 03C66 , 07E18 , 00000 , 00000 , \ Ë
\ 00000 , 03800 , 0C66C , 0FEC6 , 0C6C6 , 0386C , 00000 , 00000 , \ È
\ 00000 , 06C38 , 0C6C6 , 06CC6 , 06C6C , 0EE6C , 00000 , 00000 , \ Í
\ 00000 , 0301E , 00C18 , 0663E , 06666 , 03C66 , 00000 , 00000 , \ Î
\ 00000 , 00000 , 07E00 , 0DBDB , 07EDB , 00000 , 00000 , 00000 , \ Ï
\ 00000 , 00300 , 07E06 , 0DBDB , 07EF3 , 0C060 , 00000 , 00000 , \ Ì
\ 00000 , 0301C , 06060 , 0607C , 06060 , 01C30 , 00000 , 00000 , \ Ó
\ 00000 , 07C00 , 0C6C6 , 0C6C6 , 0C6C6 , 0C6C6 , 00000 , 00000 , \ Ô
\ 00000 , 00000 , 000FE , 0FE00 , 00000 , 000FE , 00000 , 00000 , \ 
\ 00000 , 00000 , 01818 , 0187E , 00018 , 0FF00 , 00000 , 00000 , \ Ò
\ 00000 , 03000 , 00C18 , 00C06 , 03018 , 07E00 , 00000 , 00000 , \ Ú
\ 00000 , 00C00 , 03018 , 03060 , 00C18 , 07E00 , 00000 , 00000 , \ Û
\ 00000 , 01B0E , 0181B , 01818 , 01818 , 01818 , 01818 , 01818 , \ Ù
\ 01818 , 01818 , 01818 , 01818 , 0D8D8 , 070D8 , 00000 , 00000 , \ ı
\ 00000 , 00000 , 01818 , 07E00 , 01800 , 00018 , 00000 , 00000 , \ ˆ
\ 00000 , 00000 , 07600 , 000DC , 0DC76 , 00000 , 00000 , 00000 , \ ˜
\ 03800 , 06C6C , 00038 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ¯
\ 00000 , 00000 , 00000 , 01800 , 00018 , 00000 , 00000 , 00000 , \ ≠
\ 00000 , 00000 , 00000 , 00000 , 00018 , 00000 , 00000 , 00000 , \ ˙
\ 00F00 , 00C0C , 00C0C , 0EC0C , 06C6C , 01C3C , 00000 , 00000 , \ ˚
\ 0D800 , 06C6C , 06C6C , 0006C , 00000 , 00000 , 00000 , 00000 , \ ¸
\ 07000 , 030D8 , 0C860 , 000F8 , 00000 , 00000 , 00000 , 00000 , \ ˝
\ 00000 , 00000 , 07E7E , 07E7E , 07E7E , 0007E , 00000 , 00000 , \ ˛
\ 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ 0FFh

CR .( Loading Korean fonts)
CREATE ¡°¨˜ãiç©     \ 16x16, 21 ∏a
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ¿Å∂ë
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 08021 , 08001 , 08001 , 00001 , 00000 , 00000 , \ àA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 080FF , 08019 , 08019 , 08019 , 00011 , 00000 , 00000 , \ åA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 000C0 , 00060 , 00060 , 00061 , 0803F , 00000 , 00000 , \ êA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 00060 , 00060 , 00060 , 0803F , 00000 , 00000 , \ îA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 080FF , 000CC , 000CC , 000CC , 0807F , 00000 , 00000 , \ òA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 08001 , 0007F , 00060 , 0803F , 00000 , 00000 , \ úA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 08031 , 08031 , 00031 , 0803F , 00000 , 00000 , \ †A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
08003 , 080E1 , 08061 , 0807F , 08061 , 0807F , 00040 , 00000 , \ §A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
08003 , 080ED , 0806D , 0807F , 0806D , 0807F , 00040 , 00000 , \ ®A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
0001C , 0000C , 0000C , 0001E , 00073 , 080C1 , 00000 , 00000 , \ ¨A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00036 , 00036 , 0007F , 080D9 , 08098 , 00000 , 00000 , \ ∞A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0001F , 08031 , 08020 , 08031 , 0001F , 00000 , 00000 , \ ¥A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 0000C , 0001E , 00033 , 08061 , 00000 , 00000 , \ ∏A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 080FF , 00036 , 0003E , 0806F , 080D9 , 00000 , 00000 , \ ºA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
0000C , 0807F , 0000C , 0001E , 00033 , 08061 , 00000 , 00000 , \ ¿A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 08021 , 08003 , 0803D , 00001 , 00000 , 00000 , \ ƒA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 080FF , 00060 , 0007F , 00060 , 0803F , 00000 , 00000 , \ »A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 0807F , 00023 , 00033 , 0001A , 0807F , 00000 , 00000 , \ ÃA
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
0001C , 080FF , 0003E , 00063 , 00063 , 0003E , 00000 , 00000 , \ –A
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,

CREATE ∫ó¨˜ãiç©     \ 16x16, 30 ∏a
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ¿Å∂ë
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01800 , 01E00 , 01800 , 01800 , 01800 , \ Ña
01800 , 01800 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00E00 , 07600 , 03600 , 03600 , 03E00 , 03600 , 03600 , 03600 , \ ÑÅ
03600 , 02600 , 00400 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01E00 , 01800 , 01E00 , 01800 , 01800 , \ Ñ°
01800 , 01800 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00E00 , 03600 , 03600 , 03E00 , 03600 , 03E00 , 03600 , 03600 , \ Ñ¡
03600 , 02600 , 00400 , 00000 , 00000 , 00000 , 00000 , 00000 ,
01C00 , 00C00 , 00C00 , 03C00 , 00C00 , 00C00 , 00C00 , 00C00 , \ Ñ·
00C00 , 00C00 , 00800 , 00000 , 00000 , 00000 , 00000 , 00000 ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00700 , 01B00 , 01B00 , 07B00 , 01B00 , 01B00 , 01B00 , 01B00 , \ ÖA
01B00 , 01300 , 00200 , 00000 , 00000 , 00000 , 00000 , 00000 ,
01C00 , 00C00 , 03C00 , 00C00 , 03C00 , 00C00 , 00C00 , 00C00 , \ Öa
00C00 , 00C00 , 00800 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00700 , 01B00 , 07B00 , 01B00 , 07B00 , 01B00 , 01B00 , 01B00 , \ ÖÅ
01B00 , 01300 , 00200 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 0000C , 0000C , \ Ö°
0C0FF , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01E0C , 0180C , \ Ö¡
0D8FF , 01800 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00E00 , 03600 , 03600 , 03600 , 03E00 , 03600 , 0360C , 0360C , \ Ö·
0B6FF , 02600 , 00400 , 00000 , 00000 , 00000 , 00000 , 00000 ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
03800 , 01800 , 01800 , 01800 , 01800 , 01800 , 0180C , 0180C , \ ÜA
0D8FF , 01800 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00036 , 00036 , \ Üa
0C0FF , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 0E0FF , \ ÜÅ
0000C , 0000C , 00008 , 00000 , 00000 , 00000 , 00000 , 00000 ,
01C00 , 00C00 , 00C00 , 03C00 , 00C00 , 00C00 , 00C00 , 0ECFF , \ Ü°
00C06 , 00C0C , 00800 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00700 , 01B00 , 01B00 , 07B00 , 01B00 , 01B00 , 01B00 , 0DBFF , \ Ü¡
01B0C , 01318 , 00200 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01800 , 0D8FF , \ Ü·
0180C , 01818 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 0F0FF , \ áA
00033 , 00033 , 00022 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 02000 , \ áa
0F0FF , 00040 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01800 , \ áÅ
0D8FF , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
03800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01800 , 01800 , \ á°
01800 , 01000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,

CREATE §h√±ãiç©     \ 16x16, 30 ∏a
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ¿Å∂ë
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑB
00000 , 00000 , 0C03F , 0C010 , 0C000 , 0C000 , 08000 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑC
00000 , 00000 , 0E07D , 0600C , 0600C , 0600C , 0C018 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑD
00000 , 00000 , 0C07C , 0C00C , 0E00D , 0300F , 0101A , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑE
00000 , 00000 , 00060 , 00030 , 00030 , 00030 , 0C01F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑF
00000 , 00000 , 0E063 , 08030 , 0C031 , 06033 , 0201E , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑG
00000 , 00000 , 0C060 , 0F033 , 0E031 , 03033 , 0E01D , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑH
00000 , 00000 , 0C07F , 00030 , 00030 , 00030 , 0C01F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑI
00000 , 00000 , 0C03F , 0C000 , 0C03F , 00030 , 0C01F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑJ
00000 , 00000 , 0E07F , 0600C , 0607C , 06060 , 0C03C , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑK
00000 , 00000 , 0E07F , 0600F , 0607B , 04063 , 0E03D , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑL
00000 , 00000 , 0607F , 0600F , 0E07B , 06063 , 0E03D , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑM
00000 , 00000 , 0C07C , 0C00C , 0E07D , 03063 , 0103E , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑN
00000 , 00000 , 0F07D , 0800D , 0E07D , 08061 , 0F03C , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑO
00000 , 00000 , 0F07D , 0A00C , 0A07C , 0A060 , 0F03D , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑP
00000 , 00000 , 0C07C , 0F00F , 0E07D , 03063 , 0E03D , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑQ
00000 , 00000 , 0C03F , 0C018 , 0C018 , 08018 , 0C01F , 00000 ,
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , \ ≥aª° ¥g∑q
05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA , 05555 , 0AAAA ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑS
00000 , 00000 , 08073 , 08031 , 0803F , 08031 , 0801F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑT
00000 , 00000 , 0C06C , 0C06C , 0E07D , 0306F , 0107A , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑU
00000 , 00000 , 00006 , 00006 , 0000F , 08019 , 0C070 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑV
00000 , 00000 , 0C018 , 0C018 , 0E03D , 03067 , 018C3 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑW
00000 , 00000 , 0001F , 08031 , 08020 , 08031 , 0001F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑX
00000 , 00000 , 00000 , 0807F , 0001E , 08037 , 0C061 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑY
00000 , 00000 , 00006 , 00003 , 0E03F , 0800D , 0E038 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ ÑZ
00000 , 00000 , 0C03F , 0C000 , 0C01F , 0C000 , 08001 , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ Ñ[
00000 , 00000 , 0C07F , 00030 , 0803F , 00030 , 0C01F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ Ñ\
00000 , 00000 , 0E03F , 08011 , 08019 , 00009 , 0E03F , 00000 ,
00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , 00000 , \ Ñ]
00000 , 00000 , 00003 , 0E01F , 0C00F , 06018 , 0C00F , 00000 ,

\
\ –eãi ¬âùb ê{†i
\
CR .( Loading character output words)

DECIMAL 80 CONSTANT MAX-X
VARIABLE VIR_X
VARIABLE VIR_Y

HEX
: BINARY   2 BASE ! ;
: 16* ( n -- 16*n )   2* 2* 2* 2* ;
: ñıÆA= ( char -- 0|-1 )   DUP 08 = OVER 07F = OR SWAP 0FF = OR ;

CODE INT10  ( AX -- AX )
    BX AX MOV,		\ BXàa î·£°∑Å †Ö ∂· àt∑≥ì°îa.
    10 INT,		\ AH = 0
    AX BX MOV,
    NEXT,
END-CODE

: GET-MODE ( -- mode )
    0F00 INT10 0FF AND ;

3 VALUE OldMode#

: SET-MODE  ( mode -- )   INT10 DROP ;

: VGA?	( -- flag )   1A00 INT10 0FF AND 1A = ;

0 VALUE GRAPHIC?
3 VALUE textmode#

\ for VGA graphics card
DECIMAL 30 VALUE MAX-Y			\ 640X480 –Å¨wï°; 480 / 16 = 30 ∫â
HEX

: VGA-SET-GRAPHIC  ( -- )   11 SET-MODE  -1 TO GRAPHIC? ;

\ VGA ß°ó°µ° °A°°ü°∑Å àb ∫âµA îÅ–e ≠Aãa†ÂÀa ∫Å≠°∑Å Œaüi †eók
\ Y π¡Œaù° ∑° ≠Aãa†ÂÀa àt∑i ¥Ë∑a°e X π¡Œaüi §aù°
\ µ°œa≠U ∫Å≠°ù° ≥i ÆÅ ∑∂∑sì°îa.
CREATE VGA-Y>SegTable MAX-Y 16* CELLS ALLOT

MARKER ~TEMP
:NONAME
   MAX-Y 16* 0 DO  0A000  I 5 *  +  VGA-Y>SegTable I CELLS + !	LOOP ;
EXECUTE
~TEMP	\ Œaüi ¿Å∂Åâ° ∂· ê{†i∑i ª°∂ë

\ for Hercules monochrome grahics card
DECIMAL 25 TO MAX-Y			\ 640X400 –Å¨wï°; 400 / 16 = 25 ∫â
HEX

CREATE 6854REGS 	\ 640X400 –Å¨wï°µA œ©∂a–e 6845 ùAª°Øa»· ¡°ã°àt
31 C, 28 C, 29 C, 08 C, 68 C, 02 C, 64 C, 65 C, 02 C, 03 C,

: HERC?  ( -- flag )
    03B5 PC@  4F DUP  03B5 PC!	100 0 DO LOOP
    03B5 PC@  ROT  03B5 PC!  = IF
	03BA PC@ 80 AND
	8000 0 DO 03BA PC@ 80 AND OVER <> IF UNLOOP DROP TRUE EXIT THEN LOOP
    THEN FALSE ;

: HERC-SET-GRAPHIC  ( -- )
   0A 0 DO I 03B4 PC! 6854REGS I + C@ 03B5 PC! LOOP
   1 03BF PC!		\ ãaúÅœ¢ °°óaüi –·∂w, ãaúÅœ¢ ÕA∑°ª° 1 ∑e ¨a∂w ¶âàaìw
   [ BINARY ] 00001010 [ HEX ]
   03B8 PC!		\ ãaúÅœ¢ ÕA∑°ª° 0 ∑i ãaúÅœ¢ °°óaù° ŒaØ°
   -1 TO GRAPHIC? ;

\ –·«IùAØa ß°ó°µ° °A°°ü°∑Å àb ∫âµA îÅ–e ≠Aãa†ÂÀa ∫Å≠°∑Å Œaüi †eók
\ ãaúÅœ¢ ÕA∑°ª° 1∑e 0B000:0hµA¨· Ø°∏b
\ Y π¡Œaù° ∑° ≠Aãa†ÂÀa àt∑i ¥Ë∑a°e X π¡Œaüi §aù°
\ µ°œa≠U ∫Å≠°ù° ≥i ÆÅ ∑∂∑sì°îa.
CREATE HERC-Y>SegTable MAX-Y 16* CELLS ALLOT

MARKER ~TEMP
:NONAME
   MAX-Y 16* 0 DO 0B000  I 4 MOD 200 *	+  I 4 /  5 *  +
		  HERC-Y>SegTable I CELLS + !		   LOOP ;
EXECUTE
~TEMP	\ Œaüi ¿Å∂Åâ° ∂· ê{†i∑i ª°∂ë

VARIABLE Y>SegTable
: Y>SEG  ( y -- segment_addr )
    CELLS Y>SegTable @ + @ ;

' VGA-SET-GRAPHIC VALUE 'SET-GRAPHIC

NONSTANDARD-WORDLIST SET-CURRENT
: SET-GRAPHIC  ( -- )	'SET-GRAPHIC EXECUTE ;
–eãi∑≥¬âùb-WORDLIST SET-CURRENT

DECIMAL

\ …BØaÀa Y π¡Œa∑Å —¡°eµA ŒaØ°ñE ¢Ö∏aói∑i §aù° ∂· ∫âù° µ´ã±
\ ãaúÅœ¢ π¡Œaù°ìe 16y ¶Å»· 16 àaù°∫â∑i àbàb 16 ∫â ∂·ù° µ´ã±
\ : UP-LINE
\    16* DUP 16 - DO
\      I 16 + Y>SEG  I Y>SEG
\      40 0 DO OVER I 2* L@  OVER I 2* L! LOOP	2DROP
\    LOOP ;

CODE UP-LINE  ( y -- )
   SI PUSH,
   BX DEC,
   5 # CL MOV,
   BX CL SHL,			\ BX = (VIR_Y@-1)@ * 32
   Y>SegTable ) BX ADD,
   16 # DX MOV,
1 L:
   SI SI XOR,
   DI DI XOR,
   SS:	0 [BX] ES MOV,
   SS: 32 [BX] DS MOV,
   40 # CX MOV,
   REPE, WORD MOVS,
   2 # BX ADD,
   DX DEC,
   1 L# JNE,
   SS AX MOV,
   AX DS MOV,
   SI POP,
   BX POP,
   NEXT,
END-CODE

\ …BØaÀa Y π¡Œa∑Å ∫â∑i ª°∂ë
\ : CLEAR-LINE
\    16* DUP 16 + SWAP
\    DO I Y>SEG
\	40 0 DO 0 OVER I 2* L! LOOP  DROP
\    LOOP ;

CODE CLEAR-LINE  ( y -- )
   5 # CL MOV,
   BX CL SHL,			\ BX = VIR_Y@ * 32
   Y>SegTable ) BX ADD,
   AX AX XOR,
   16 # DX MOV,
1 L:
   0 [BX] ES MOV,
   DI DI XOR,
   40 # CX MOV,
   REPE,
   WORD STOS,
   2 # BX ADD,
   DX DEC,
   1 L# JNE,
   BX POP,
   NEXT,
END-CODE

HEX
VARIABLE VSCR0
VARIABLE YY
VARIABLE XX
1000 CONSTANT VSCREEN-SIZE
0FFF CONSTANT VSCR-MASK
CREATE VSCREEN VSCREEN-SIZE CHARS ALLOT
: >VSCR-ADDR   ( offset -- c_addr )
    VSCR0 @ + VSCR-MASK AND VSCREEN + ;

DECIMAL

\ : EFONT!  ( x y char -- )
\    16* ENGFONT +	  \ x y font-addr
\    SWAP 16*		  \ x font-addr 16y
\    16 0 DO OVER I + C@ OVER I + Y>SEG 4 PICK LC! LOOP DROP 2DROP ;

CODE EFONT!  ( x y char -- )
   SI DX MOV,		\ MOV	DX,SI
   BX SI MOV,		\ MOV	SI,BX
   BX POP,		\ POP	BX
   DI POP,		\ POP	DI
   4 # CL MOV,		\ MOV	CL,#4
   SI CL SHL,		\ SHL	SI,CL
   ENGFONT # SI ADD,	\ ADD	SI,ENGFONT	; SI = font-addr
   CL INC,		\ INC	CL		; CL = 5
   BX CL SHL,		\ SHL	BX,CL		; BX = VIR_Y@ * 32
   Y>SegTable ) BX ADD,
   2 # CX MOV,
 15
   0 [BX] ES MOV, BYTE LODS, ES: AL 0 [DI] MOV, CX BX ADD, 1- ?DUP [IF] 0 >IN ! [THEN]
   0 [BX] ES MOV, BYTE LODS, ES: AL 0 [DI] MOV,
   DX SI MOV,
   BX POP,
   NEXT,
END-CODE

BINARY
00001 CONSTANT ¿Å∂ë¡°¨˜
00010 CONSTANT ¿Å∂ë∫ó¨˜
00001 CONSTANT ¿Å∂ë§h√±
1000010001000001 CONSTANT ¿Å∂ë∏a	\ ¡°¨˜, ∫ó¨˜, §h√± °°ñÅ ¿Å∂ë∏a
0111110000000000 CONSTANT ¡°¨˜••
0000001111100000 CONSTANT ∫ó¨˜••
0000000000011111 CONSTANT §h√±••
1000001111111111 CONSTANT ¡°¨˜ª°∂ë••
1111110000011111 CONSTANT ∫ó¨˜ª°∂ë••
1111111111100000 CONSTANT §h√±ª°∂ë••
DECIMAL

VARIABLE HCHAR

\ VARIABLE H1FONT
\ VARIABLE H2FONT
\ VARIABLE H3FONT
\
\ : HFONT!  ( x y 16_bit_hangul_code -- )
\    DUP [ BINARY ] 0111110000000000 AND [ DECIMAL ]	  \ ¿ı∏a
\    5 RSHIFT ( == 10 RSHIFT 16* 2* ) ¡°¨˜ãiç© + H1FONT !
\    \ ãiç© ∫Å≠°, –eãi∑e Õ¢∑° 2 §a∑°Àa
\    DUP [ BINARY ] 0000001111100000 AND [ DECIMAL ]	  \ àa∂ÖïA∏a
\    ( 5 RSHIFT 16* 2* == noop ) ∫ó¨˜ãiç© + H2FONT !
\    [ BINARY ] 0000000000011111 AND [ DECIMAL ]	  \ §h√±
\    16* 2* §h√±ãiç© + H3FONT !
\    16*
\    16 0 DO H1FONT @ @
\	     H2FONT @ @ OR
\	     H3FONT @ @ OR
\	     OVER I + Y>SEG 3 PICK L!
\	     2 H1FONT +!  2 H2FONT +!  2 H3FONT +!
\	  LOOP	2DROP ;

CODE HFONT!  ( x y 16_bit_hangul_code -- )
    BX DI MOV,
    BX POP,
    DX POP,
    BP PUSH,
    SI PUSH,
    DI SI MOV,
    DI BP MOV,
    ¡°¨˜•• # SI AND,
    ∫ó¨˜•• # DI AND,
    §h√±•• # BP AND,
    5 # CL MOV,
    SI CL SHR,
    ¡°¨˜ãiç© # SI ADD,		 \ SI = ¿ı∏a ãiç©
    ∫ó¨˜ãiç© # DI ADD,		 \ DI = àa∂ÖïA∏a ãiç©
    BP CL SHL,
    §h√±ãiç© # BP ADD,		 \ BP = §h√± ãiç©
    BX CL SHL,			 \ BX = VIR_Y@ * 32
    Y>SegTable ) BX ADD,
    2 # CX MOV,
  15
    WORD LODS, 0 [DI] AX OR, 0 [BP] AX OR, 0 [BX] ES MOV, BX DX XCHG, ES: AX 0 [BX] MOV, BX DX XCHG, CX DI ADD, CX BX ADD, CX BP ADD, 1- ?DUP [IF] 0 >IN ! [THEN]
    WORD LODS, 0 [DI] AX OR, 0 [BP] AX OR, 0 [BX] ES MOV, BX DX XCHG, ES: AX 0 [BX] MOV,
    SI POP,
    BP POP,
    BX POP,
    NEXT,
END-CODE

: xySTR!  ( x y c_addr u -- )
    BEGIN >R >R 2DUP R@ C@
	  DUP 128 < IF EFONT!
	  ELSE 8 LSHIFT R> CHAR+ DUP >R C@ OR HFONT! SWAP 1+ SWAP
	  THEN
	  SWAP 1+ SWAP R> CHAR+ R> 1- DUP 0=
    UNTIL 2DROP 2DROP ;

DECIMAL 30 TO MAX-Y

CREATE MAX-X*Table MAX-Y 1+ CELLS ALLOT
MARKER ~TEMP
:NONAME   MAX-Y 1+ 0 DO I MAX-X *  MAX-X*Table I CELLS +  !  LOOP ; EXECUTE
~TEMP
: MAX-X*  ( y -- MAX_X*y )   CELLS MAX-X*Table + @ ;

HEX
: SHOW-LINE  ( y -- )		\ àa¨w—¡°e∑Å y ∫â∑i ãaúÅœ¢ —¡°eµA ŒaØ°
    >R 1 MAX-X* 0				\ max-x 0  R: y
    BEGIN
       DUP R@ OVER >VSCR-ADDR DUP C@		\ max-x x x 0 c_addr char
       DUP 80 < IF NIP EFONT!
       ELSE 8 LSHIFT
	    SWAP CHAR+ C@ OR HFONT! CHAR+ THEN
       CHAR+ 2DUP =
    UNTIL 2DROP R> DROP ;

0 VALUE YTop

: SCROLL  ( -- )
    MAX-Y MAX-X* DUP MAX-X + SWAP
    DO BL I >VSCR-ADDR C! LOOP
    MAX-Y 1-  MAX-X 0 DO I OVER BL EFONT! LOOP DROP
    VSCR0 @ MAX-X + VSCR-MASK AND VSCR0 !
    YTop SHOW-LINE
    0 XX !  YTop YY ! ;

: VIR_X+!  ( n -- )
    VIR_X @ + MAX-X /MOD VIR_Y +! VIR_X !
    VIR_Y @ MAX-Y = IF SCROLL -1 VIR_Y +! THEN ;

: VSCR!  ( char -- )   VIR_Y @ MAX-X* VIR_X @ + >VSCR-ADDR C! ;

: multiEMIT  ( char -- )
    DUP ñıÆA= IF DROP VIR_X @ VIR_Y @ BL EFONT! -1 VIR_X +! BL VSCR! EXIT THEN
    DUP 0D ( CR) =  IF DROP  0 VIR_X !				     EXIT THEN
    DUP 0A ( LF) =  IF DROP  VIR_Y @ 1+ MAX-Y < IF 1 VIR_Y +! EXIT THEN
			     SCROLL				     EXIT THEN
    VSCR!  1 VIR_X+! ;

: HEMIT  ( char -- )
    HCHAR @ 0= IF			\ ¨Åù° Ø°∏b–aìe ãi∏a
      DUP 80 < IF multiEMIT EXIT THEN	\ –eãi∑° ¥aì°°e ãaîÅù° ¬âùb
      VIR_X @ 1+ MAX-X = IF VIR_X @ multiEMIT BL multiEMIT THEN
      HCHAR ! EXIT			\ ¿ı 8 ß°Àa §e∏aüi ài¢Åü°
    THEN
    HCHAR @ multiEMIT  multiEMIT  0 HCHAR ! ;

\
\ –eãi ∑≥ùb ê{†iói
\

CR .( Loading character input words)

CODE INT16h
   BX AX MOV,
   16 INT,
   AX BX MOV,
   NEXT,
END-CODE

\ †aª°†b ãiÆA ∑≥ùb òÅ ∂EΩ¢ ∂ıãiÆAàa íâùv∑a°e ¿q, ¥aì°°e à·ªµ
: ∂EΩ¢∂ıÆAíâü±?  ( -- flag )
	200 INT16h  [ BINARY ] 00000010 [ HEX ] AND 0= 0= ;

\ †aª°†b ãiÆA ∑≥ùb òÅ CapsLock ¨w»Åµv∑a°e ¿q, ¥aì°°e à·ªµ
: CapsLock?  ( -- flag )
	200 INT16h  [ BINARY ] 01000000 [ HEX ] AND 0= 0= ;

VARIABLE ãiÆA∑≥ùb¨w»Å
VARIABLE ãiÆA…∑
VARIABLE £°µ≈¨˜∏a
CREATE ãiÆA∑≥ùb¨w»Åã°¥‚  8 CELLS ALLOT
CREATE £°µ≈¨˜∏aã°¥‚	 8 CELLS ALLOT
VARIABLE ºÅ∑≥ùb¨w»Å
VARIABLE ºÅ£°µ≈¨˜∏a
: ¥|∏aã°¥‚  ( -- )
    £°µ≈¨˜∏a @	ºÅ£°µ≈¨˜∏a @ 7 AND CELLS £°µ≈¨˜∏aã°¥‚ + !
    1 ºÅ£°µ≈¨˜∏a +! ;
: ¨w»Åã°¥‚  ( ¨w»Å -- )
    ºÅ∑≥ùb¨w»Å @ 7 AND CELLS ãiÆA∑≥ùb¨w»Åã°¥‚ + !
    1 ºÅ∑≥ùb¨w»Å +! ;

DECIMAL
: |  ( "<spaces>name" -- )   ' , ;
: ƒe ;
: µ°…°†a»a:  ( width -- )
	CREATE , ;
: ;µ°…°†a»a
	DOES>
	TUCK @				\ ∫Å≠° π∑üA ƒeÆÅ
	ãiÆA∑≥ùb¨w»Å @
	DUP ¨w»Åã°¥‚ ¥|∏aã°¥‚	      \ –eãiãi∏a∑°°e
	* + 2* CELLS + CELL+
	DUP >R
	@ EXECUTE
	R> CELL+
	@ EXECUTE
	ãiÆA∑≥ùb¨w»Å ! ;

0 CONSTANT >0 IMMEDIATE
1 CONSTANT >1 IMMEDIATE
2 CONSTANT >2 IMMEDIATE
3 CONSTANT >3 IMMEDIATE
5 CONSTANT >5 IMMEDIATE

HEX
\ §eó°àa —¡°e µ°üeΩ¢è{µA ∑∂∑a°e îa∑q–óµA¨· ∑≥ùb§h∑q
: §eó°∂·√°π°∏˜	( -- )	 VIR_X @ 1+ MAX-X = ( -1|0) NEGATE VIR_X+! ;
: £°µ≈¨˜∏a•°µa	 ( -- )   VIR_X @  VIR_Y @  £°µ≈¨˜∏a @	HFONT! ;
: ãaê∑	( -- )	 VIR_X @ VIR_Y @  BL  EFONT! ;
: ¿Å∂ë!  ( -- )   ¿Å∂ë∏a  £°µ≈¨˜∏a !  1 ¨w»Åã°¥‚  ¥|∏aã°¥‚ ;
: £°µ≈¨˜∏a¡°¨˜	( -- ¡°¨˜ )   £°µ≈¨˜∏a @  ¡°¨˜••  AND 0A RSHIFT ;
: £°µ≈¨˜∏a∫ó¨˜	( -- ∫ó¨˜ )   £°µ≈¨˜∏a @  ∫ó¨˜••  AND 05 RSHIFT ;
: £°µ≈¨˜∏a§h√±	( -- §h√± )   £°µ≈¨˜∏a @  §h√±••  AND ;
: ∑≥ùbâÅ≠¢  ( -- 0 )   £°µ≈¨˜∏a•°µa 0 ;
: ê{∏a§aé°  ( àt ª°∂ë•• -- )   £°µ≈¨˜∏a @  AND	OR  £°µ≈¨˜∏a ! ;
: ¡°¨˜§aé°  ( ¡°¨˜ -- )   0A LSHIFT  ¡°¨˜ª°∂ë•• ê{∏a§aé° ;
: ∫ó¨˜§aé°  ( ∫ó¨˜ -- )   05 LSHIFT  ∫ó¨˜ª°∂ë•• ê{∏a§aé° ;
: §h√±§aé°  ( §h√± -- ) 	     §h√±ª°∂ë•• ê{∏a§aé° ;
: ¡°¨˜!   ( ¡°¨˜ -- 0 )   §eó°∂·√°π°∏˜	¡°¨˜§aé° ∑≥ùbâÅ≠¢ ;
: ∫ó¨˜!   ( ∫ó¨˜ -- 0 ) 		∫ó¨˜§aé° ∑≥ùbâÅ≠¢ ;

: µ≈¨˜	 (    0 -- 16ß°Àa∏a )	DROP	  £°µ≈¨˜∏a @  ¿Å∂ë! ;
: µ≈+ch  ( char -- 16ß°Àa∏a )	ãiÆA…∑ !  £°µ≈¨˜∏a @  ¿Å∂ë! ;
: µ≈+¡°  ( ¡°¨˜ -- 16ß°Àa∏a )	£°µ≈¨˜∏a @  ¿Å∂ë!  SWAP ¡°¨˜§aé° ;
: µ≈+∫ó  ( ∫ó¨˜ -- 16ß°Àa∏a )	£°µ≈¨˜∏a @  ¿Å∂ë!  SWAP ∫ó¨˜§aé° ;

: ñ·ù°	( ñıÆA -- 0 )
    DROP -2 ºÅ£°µ≈¨˜∏a +!
    ºÅ£°µ≈¨˜∏a @ 7 AND CELLS £°µ≈¨˜∏aã°¥‚ + @  £°µ≈¨˜∏a !  ∑≥ùbâÅ≠¢ ;
: >ñ·  ( -- ¥|¨w»Å )
    -2 ºÅ∑≥ùb¨w»Å +!
    ºÅ∑≥ùb¨w»Å @ 7 AND CELLS ãiÆA∑≥ùb¨w»Åã°¥‚ + @ ;

CREATE ¡°¨˜>âs¡°¨˜Œa  \ âs¡°¨˜∑i †eóiÆÅ ∑∂ìe àA,îA,§A,¨A,∏AµA îÅ–Å¨·ìe 1,
		      \ ¥aì°°e 0
\ *   ¿Å∂ë  àA	 åA   êA   îA	òA   úA   †A   §A   ®A
  0 C, 0 C, 1 C, 0 C, 0 C, 1 C, 0 C, 0 C, 0 C, 1 C, 0 C,
\ ¨A   ∞A   ¥A	 ∏A   ºA   ¿A	ƒA   »A   ÃA   –A
  1 C, 0 C, 0 C, 1 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C,  ALIGN

CREATE ¡°¨˜>§h√±Œa  \ §h√±∑° ¥aì• ¡°¨˜ òA,®A,ºAµA îÅ–Å¨·ìe 0, ¥aì°°e §h√±àt
\ *   ¿Å∂ë  àA	 åA   êA   îA	òA   úA   †A	§A    ®A
  0 C, 1 C, 2 C, 3 C, 5 C, 8 C, 0 C, 9 C, 11 C, 13 C, 0 C,
\ ¨A	∞A    ¥A    ∏A	  ºA   ¿A    ƒA    »A	 ÃA    –A
  15 C, 16 C, 17 C, 18 C, 0 C, 19 C, 1A C, 1B C, 1C C, 1D C,  ALIGN

CREATE §h√±>—ª§h√±¡°¨˜Œa  \ âs§h√±: ∂·8ß°Àaìe —ª§h√±àt, ¥aúÅ8ß°Àaìe ¡°¨˜àt
			  \ —ª§h√±: ∂·8ß°Àaìe	¿Å∂ëàt, ¥aúÅ8ß°Àaìe ¡°¨˜àt
\  *   ¿Å∂ë  ÑB     ÑC	   ÑD	  ÑE	 ÑF	ÑG     ÑH     ÑI
   0 ,	0 , 0102 , 0103 , 020B , 0104 , 050E , 0514 , 0105 , 0107 ,
\  ÑJ	  ÑK	 ÑL	ÑM     ÑN     ÑO     ÑP     ÑQ	   *	ÑS
  0902 , 0908 , 0909 , 090B , 0912 , 0913 , 0914 , 0108 ,  0 , 0109 ,
\  ÑT	  ÑU	 ÑV	ÑW     ÑX     ÑY     ÑZ     Ñ[	   Ñ\	  Ñ]
  130B , 010B , 010C , 010D , 010E , 0110 , 0111 , 0112 , 0113 , 0114 ,

CREATE úA¡°¨˜>âs§h√±Œa	\ úAâ¡ âs§h√±∑i †eóiÆÅ ∑∂ìe ¡°¨˜∑°°e âs§h√±àt, ¥aì°°e 0
\ *   ¿Å∂ë   àA   åA   êA   îA	 òA   úA   †A	 §A    ®A
  0 C, 0 C, 0A C, 0 C, 0 C, 0 C, 0 C, 0 C, 0B C, 0C C, 0 C,
\ ¨A	∞A   ¥A   ∏A   ºA   ¿A	 ƒA   »A    ÃA	  –A
  0D C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0E C, 0F C, 10 C,  ALIGN

CREATE âs>—ª∫ó¨˜Œa  \ âs∫ó¨˜µA îÅ–Å ¥|—ª∫ó¨˜àt, âs∫ó¨˜∑° ¥aì°°e 0
\   *	*   ¿Å∂ë Ña   ÑÅ   Ñ°	Ñ¡   Ñ·    *	*
   0 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C, 0 C,
\ ÖA   Öa   ÖÅ	  Ö°   Ö¡    Ö·    *	*    ÜA    Üa
   0 C, 0 C, 0 C, 0 C, 0D C, 0D C, 0 C, 0 C, 0D C, 0 C,
\ ÜÅ   Ü°    Ü¡    Ü·	 *    *    áA	áa   áÅ   á°
  0 C, 14 C, 14 C, 14 C, 0 C, 0 C, 0 C, 0 C, 1B C, 0 C,

: ¡°¨˜>âs¡°¨˜? ( ¡°¨˜ -- ¡°¨˜ 0 | âs¡°¨˜ -1 )
    DUP £°µ≈¨˜∏a¡°¨˜ = IF
	DUP CHARS ¡°¨˜>âs¡°¨˜Œa + C@ 1 = IF 1+ -1 EXIT THEN  THEN
    0 ;
: âs¡°¨˜?  ( ¡°¨˜ -- 0 | 16ß°Àa–eãi∏a )
    ¡°¨˜>âs¡°¨˜? IF   ¡°¨˜§aé° ∑≥ùbâÅ≠¢
		 ELSE £°µ≈¨˜∏a @ SWAP ¿Å∂ë!  ¡°¨˜§aé° THEN ;
: ¡°¨˜>§h√±?  ( ¡°¨˜ -- ¡°¨˜ 0 | §h√± -1 )
	DUP CHARS  ¡°¨˜>§h√±Œa + C@ DUP IF NIP -1 EXIT THEN ;
: úA¡°¨˜>âs§h√±   ( ¡°¨˜ -- 0|âs§h√± )	 CHARS	úA¡°¨˜>âs§h√±Œa + C@ ;
: âs>—ª∫ó¨˜   ( ∫ó¨˜ -- 0|—ª∫ó¨˜ )   CHARS  âs>—ª∫ó¨˜Œa + C@ ;
: âs>¥|—ª§h√± ( §h√± -- 0|—ª§h√± )
	CELLS  §h√±>—ª§h√±¡°¨˜Œa +  @  8 RSHIFT  DUP ¿Å∂ë§h√± <>  AND ;
: §h√±>§h√±¡°¨˜  ( §h√± -- §h√± ¡°¨˜ )
	CELLS §h√±>—ª§h√±¡°¨˜Œa + @  DUP 8 RSHIFT  SWAP 0FF AND ;

\ î}≠°ü°àa òA, ®A, ºA∑°°e µ≈¨˜, ¥aì°°e §h√±µA ê˝â° âÅ≠¢
: §h√±?  ( ¡°¨˜ -- 0 | 16ß°Àa–eãi∏a )
    ¡°¨˜>§h√±?	IF   §h√±§aé°  ∑≥ùbâÅ≠¢
		ELSE £°µ≈¨˜∏a @  SWAP  ¿Å∂ë!  ¡°¨˜§aé°	THEN ;
: >3?  ( -- 3|4 )   £°µ≈¨˜∏a∫ó¨˜  âs>—ª∫ó¨˜ 0= ( -1|0) 4 + ;
: >5?  ( -- 2|5 )   £°µ≈¨˜∏a§h√±  ¿Å∂ë§h√± = ( -1|0) 3 * 5 + ;
: >6?  ( -- 2|6 )   £°µ≈¨˜∏a§h√±  ¿Å∂ë§h√± = ( -1|0) 2* 2* 6 + ;

: ¡°¨˜>âs§h√±?	( ¡°¨˜ -- ¡°¨˜ 0 | âs§h√± -1 )
    £°µ≈¨˜∏a§h√±
    CASE
      ( ÑB) 02 OF DUP ( ¨A) 0B = IF DROP 04 -1 EXIT THEN  ENDOF
      ( ÑS) 13 OF DUP ( ¨A) 0B = IF DROP 14 -1 EXIT THEN  ENDOF
      ( ÑE) 05 OF DUP ( ∏A) 0E = IF DROP 06 -1 EXIT THEN
		  DUP ( –A) 14 = IF DROP 07 -1 EXIT THEN  ENDOF
      ( ÑI) 09 OF DUP úA¡°¨˜>âs§h√± ?DUP IF NIP -1 EXIT THEN  ENDOF
    ENDCASE  0 ;

: âs§h√±?  ( ¡°¨˜ -- 0 | 16ß°Àa–eãi∏a )
	¡°¨˜>âs§h√±? IF  §h√±§aé° ∑≥ùbâÅ≠¢  ELSE  µ≈+¡°  THEN ;
: —ª§h√±  ( ñıÆA -- 0 )
	DROP  £°µ≈¨˜∏a§h√±  âs>¥|—ª§h√± §h√±§aé°  ∑≥ùbâÅ≠¢ ;

: ∫ó¨˜>âs∫ó¨˜?	( ∫ó¨˜ -- ∫ó¨˜ 0 | âs∫ó¨˜ -1 )
    £°µ≈¨˜∏a∫ó¨˜
    CASE
      ( áa) 1B OF DUP ( á°) 1D = IF DROP 1C -1 EXIT THEN
		  0 EXIT				    ENDOF
      ( Ö°) 0D OF DUP ( Ña) 03 = IF DROP 0E -1 EXIT THEN
		  DUP ( ÑÅ) 04 = IF DROP 0F -1 EXIT THEN
		  DUP ( á°) 1D = IF DROP 12 -1 EXIT THEN
		  0 EXIT				    ENDOF
      ( ÜÅ) 14 OF DUP ( Ñ·) 07 = IF DROP 15 -1 EXIT THEN
		  DUP ( ÖA) 0A = IF DROP 16 -1 EXIT THEN
		  DUP ( á°) 1D = IF DROP 17 -1 EXIT THEN
		  0 EXIT				    ENDOF
    ENDCASE  0 ;

: âs∫ó¨˜?  ( ∫ó¨˜ -- 0 | 16ß°Àa–eãi∏a )
	∫ó¨˜>âs∫ó¨˜? IF  ∫ó¨˜§aé° ∑≥ùbâÅ≠¢  ELSE  µ≈+∫ó  THEN ;
: —ª∫ó¨˜  ( ñıÆA -- 0 )
	DROP  £°µ≈¨˜∏a∫ó¨˜  âs>—ª∫ó¨˜ ∫ó¨˜§aé°	∑≥ùbâÅ≠¢ ;

\ £°µ≈¨˜∏aµA¨· §h√±∑i ®Ö ãi∏aüi µ≈¨˜∏aù° êÅ•°êÅâ°
\ ãa §h√±∑i £°µ≈¨˜∏a∑Å ¡°¨˜µA ê˝â° ∫ó¨˜∑i £°µ≈¨˜∏aµA ê˝∑q
: µ≈+¡°∫ó  ( ∫ó¨˜ -- 16ß°Àa∏a )
    £°µ≈¨˜∏a§h√± §h√±>§h√±¡°¨˜		\ ∫ó¨˜ ¨Å§h√± ¡°¨˜
    SWAP §h√±§aé° £°µ≈¨˜∏a @		\ ∫ó¨˜ ¡°¨˜ 16ß°Àa–eãi∏a
    ¿Å∂ë!  SWAP ¡°¨˜§aé° 2 ¨w»Åã°¥‚ ¥|∏aã°¥‚  SWAP ∫ó¨˜§aé° ;

CREATE µwÆA>–eãi∏a
\  a>†A  b>áA  c>¿A  d>¥A  e>îA  f>úA  g>–A  h>Ö°  i>Ñ°  j>Ñ·
   308 , 41A , 310 , 30D , 305 , 307 , 314 , 40D , 405 , 407 ,
\  k>Ña  l>á°  m>áa  n>ÜÅ  o>ÑÅ  p>ÖA  q>§A  r>àA  s>êA  t>¨A
   403 , 41D , 41B , 414 , 404 , 40A , 309 , 302 , 304 , 30B ,
\  u>Öa  v>ÃA  w>∏A  x>»A  y>Üa  z>ƒA
   40B , 313 , 30E , 312 , 413 , 311 ,

CREATE µw∂ıÆA>–eãi∏a
\  A>A	 B>B   C>C   D>D   E>òA  F>F   G>G   H>H   I>I	 J>J
   041 , 042 , 043 , 044 , 306 , 046 , 047 , 048 , 049 , 04A ,
\  K>K	 L>L   M>M   N>N   O>Ñ¡  P>ÖÅ  Q>®A  R>åA  S>S	 T>∞A
   04B , 04C , 04D , 04E , 406 , 40C , 30A , 303 , 053 , 30C ,
\  U>U	 V>V   W>ºA  X>X   Y>Y	 Z>Z
   055 , 056 , 30F , 058 , 059 , 05A ,

\ EKEY ù° §h∑e àtµA¨· ãiÆA∑Å π∑üAüi '>ãi∏a-2§ÈØ¢'ù° êÒã±
\ 2§ÈØ¢µA¨· ãiÆA π∑üAìe îa¨ı àaª°:
\ –eµw§aéë(1), ñıÆA(2), î}≠°ü°(3), —©≠°ü°(4), êa†·ª°(0)
: >ãiÆAàtâ¡π∑üA-2§ÈØ¢  ( ãiÆAàt -- ãiÆAàt' π∑üA )
   0FF AND						\ special key ìe ¢ÅØ°
   DUP BL = ∂EΩ¢∂ıÆAíâü±? AND IF DROP 0 1 EXIT THEN	\ –eµw§aéëãiÆA∑°°e 0 1
   DUP ñıÆA=  IF DROP 8 2 EXIT THEN			\ ñıãiÆA∑°°e
   DUP [CHAR] A [CHAR] Z 1+ WITHIN ãiÆA∑≥ùb¨w»Å @ AND IF \ –eãi∑≥ùb∑°â° A-Z ∑°°e
	[CHAR] A -  CELLS   µw∂ıÆA>–eãi∏a
	[ µwÆA>–eãi∏a µw∂ıÆA>–eãi∏a - ] LITERAL CapsLock? AND
	+ + @  DUP 0FF AND SWAP 8 RSHIFT EXIT			THEN
   DUP [CHAR] a [CHAR] z 1+ WITHIN ãiÆA∑≥ùb¨w»Å @ AND IF \ –eãi∑≥ùb∑°â° a-z ∑°°e
	[CHAR] a -  CELLS   µwÆA>–eãi∏a
	[ µw∂ıÆA>–eãi∏a µwÆA>–eãi∏a - ] LITERAL CapsLock? AND
	+ + @  DUP 0FF AND SWAP 8 RSHIFT EXIT			THEN
   0 ;					\ êa†·ª°

\ 2§ÈØ¢ ∏aÃe ¨w»Å
\  0 : µw¢Ö ∑≥ùb
\  1 : –eãi∑≥ùb Ø°∏b
\  2 : ¡°¨˜ ∑≥ùb
\  3 : ¡°¨˜+∫ó¨˜ ∑≥ùb ( ¡°¨˜µA ¿Å∂ë ãi∏aï° –·∂w )
\  4 : ¡°¨˜+âs∫ó¨˜ ∑≥ùb ( ¡°¨˜µA ¿Å∂ë ãi∏aï° –·∂w )
\  5 : ¡°¨˜+∫ó¨˜+§h√± ∑≥ùb
\  6 : ¡°¨˜+∫ó¨˜+âs§h√± ∑≥ùb
5 ƒe µ°…°†a»a: >ãi∏a-2§ÈØ¢
\ ∑≥ùb|   êa†·ª°?  | –eµw§aéë?	|   ñıÆA?    |	  î}≠°ü°?    |	 —©≠°ü°?   |
\ ¨w»Å----------------------------------------------------------------------
 ( 0) | ãaê∑  | >0 | ¿Å∂ë! | >1 | ãaê∑ | >0  | ãaê∑    | >0  | ãaê∑    | >0
 ( 1) | ãaê∑  | >1 | ãaê∑  | >0 | ãaê∑ | >1  | ¡°¨˜!   | >2  | ∫ó¨˜!   | >3
 ( 2) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | âs¡°¨˜? | >2  | ∫ó¨˜!   | >3
 ( 3) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | §h√±?   | >5? | âs∫ó¨˜? | >3?
 ( 4) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | §h√±?   | >5? | µ≈+∫ó   | >3
 ( 5) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | âs§h√±? | >6? | µ≈+¡°∫ó | >3
 ( 6) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | µ≈+¡°   | >2  | µ≈+¡°∫ó | >3
;µ°…°†a»a

\
\  3§ÈØ¢ ∏aÃe ∑≥ùbµA œ©∂a–e ê{†iói
\

CREATE úA§h√±>âs§h√±Œa	\ úAâ¡ âs§h√±∑i †eóiÆÅ ∑∂ìe §h√±∑°°e âs§h√±àt, ¥aì°°e 0
\  *   ¿Å∂ë   ÑB    ÑC	  ÑD	ÑE    ÑF    ÑG	  ÑH	ÑI
   0 C,  0 C, 0A C,  0 C,  0 C,  0 C,  0 C,  0 C,  0 C,  0 C,
\ ÑJ	ÑK    ÑL    ÑM	  ÑN	ÑO    ÑP    ÑQ	   *	ÑS
   0 C,  0 C,  0 C,  0 C,  0 C,  0 C,  0 C, 0B C,  0 C, 0C C,
\ ÑT	ÑU    ÑV    ÑW	  ÑX	ÑY    ÑZ    Ñ[	  Ñ\	Ñ]
   0 C, 0D C,  0 C,  0 C,  0 C,  0 C,  0 C, 0E C, 0F C, 10 C, ALIGN

: §h√±!    ( §h√± -- 0 )	  §h√±§aé° ∑≥ùbâÅ≠¢ ;
: µ≈+§h√±  ( §h√± -- 16ß°Àa∏a )   £°µ≈¨˜∏a @  ¿Å∂ë!  SWAP §h√±§aé° ;
: úA§h√±>âs§h√±  ( §h√± -- 0|âs§h√± )	CHARS  úA§h√±>âs§h√±Œa + C@ ;
: §h√±>âs§h√±?	( §h√± -- §h√± 0 | âs§h√± -1 )
    £°µ≈¨˜∏a§h√±
    CASE
      ( ÑB) 02 OF DUP ( ÑB) 02 = IF DROP 03 -1 EXIT THEN
		      ( ÑU) 15 = IF DROP 04 -1 EXIT THEN  ENDOF
      ( ÑS) 13 OF DUP ( ÑU) 15 = IF DROP 14 -1 EXIT THEN  ENDOF
      ( ÑU) 15 OF DUP ( ÑU) 15 = IF DROP 16 -1 EXIT THEN  ENDOF
      ( ÑE) 05 OF DUP ( ÑX) 18 = IF DROP 06 -1 EXIT THEN
		  DUP ( Ñ]) 1D = IF DROP 07 -1 EXIT THEN  ENDOF
      ( ÑI) 09 OF DUP úA§h√±>âs§h√± ?DUP IF NIP -1 EXIT THEN  ENDOF
    ENDCASE  0 ;
: âs§h√±?  ( §h√± -- 0 | 16ß°Àa–eãi∏a )
	§h√±>âs§h√±? IF  §h√±§aé° ∑≥ùbâÅ≠¢  ELSE  µ≈+§h√±  THEN ;

CREATE 3§ÈÆA>–eãi∏a
\  !>ÑX  ">"   #>#   $>$   %>%   &>&   '>»A  (>(   )>)   *>*   +>+   ,>,
   518 , 022 , 023 , 024 , 025 , 026 , 312 , 028 , 029 , 02A , 02B , 02C ,
\  ->-	 .>.   />Ö°  0>ƒA  1>Ñ]  2>ÑV  3>ÑS  4>Üa  5>áA  6>Ñ°  7>ÖÅ  8>áÅ
   02D , 02E , 40D , 311 , 51D , 516 , 513 , 413 , 41A , 405 , 40C , 41C ,
\  9>ÜÅ  :>:   ;>§A  <>2   =>=	 >>3   ?>?   @>@   A>ÑH  B>!   C>ÑK  D>ÑJ
   414 , 03A , 309 , 032 , 03D , 033 , 03F , 040 , 508 , 021 , 50B , 50A ,
\  E>ÑZ  F>ÑC  G>/   H>'   I>8   J>4   K>5   L>6   M>1   N>0   O>9   P>>
   51A , 503 , 02F , 027 , 038 , 034 , 035 , 036 , 031 , 030 , 039 , 03E ,
\  Q>Ñ\  R>Ñ¡  S>ÑG  T>;   U>7	 V>ÑP  W>Ñ[  X>ÑT  Y>8	 Z>ÑY  [>[   \>\
   51C , 406 , 507 , 03B , 037 , 510 , 51B , 514 , 038 , 519 , 05B , 05C ,
\  ]>]	 ^>^   _>_   `>`   a>ÑW  b>ÜÅ  c>ÖA  d>á°  e>Öa  f>Ña  g>áa  h>êA
   05D , 05E , 05F , 060 , 517 , 414 , 40A , 41D , 40B , 403 , 41B , 304 ,
\  i>†A  j>¥A  k>àA  l>∏A  m>–A  n>¨A  o>¿A  p>ÃA  q>ÑU  r>ÑÅ  s>ÑE  t>Ñ·
   308 , 30D , 302 , 30E , 314 , 30B , 310 , 313 , 515 , 404 , 505 , 407 ,
\  u>îA  v>Ö°  w>ÑI  x>ÑB  y>úA  z>ÑQ  {>{   |>|   }>}	 ~>~
   305 , 40D , 509 , 502 , 307 , 511 , 07B , 07C , 07D , 07E ,

\ EKEY ù° §h∑e àtµA¨· ãiÆA∑Å π∑üAüi '>ãi∏a-3§ÈØ¢'∑aù° êÒã±
\ 3§ÈØ¢µA¨· ãiÆA π∑üAìe îa¨ı àaª°:
\   –eµw§aéë(1), ñıÆA(2), ¡°¨˜(3), ∫ó¨˜(4), §h√±(5), êa†·ª°(0)
: >ãiÆAàtâ¡π∑üA-3§ÈØ¢  ( ãiÆAàt -- ãiÆAàt' π∑üA )
   0FF AND						\ special key ìe ¢ÅØ°
   DUP BL = ∂EΩ¢∂ıÆAíâü±? AND IF DROP 0 1 EXIT THEN	\ –eµw§aéëãiÆA∑°°e 0 1
   DUP ñıÆA=  IF DROP 8 2 EXIT THEN			\ ñıãiÆA∑°°e
   DUP BL > 0= IF 0 EXIT THEN				\ πA¥·¢Ö∏aêa ß•ƒe∑°°e
   ãiÆA∑≥ùb¨w»Å @ 0= IF 0 EXIT THEN			\ µw¢Ö∑≥ùb
   CapsLock? IF
       DUP [CHAR] A [CHAR] Z 1+ WITHIN IF
	   [ CHAR a CHAR A - ] LITERAL +
       ELSE DUP [CHAR] a [CHAR] z 1+ WITHIN IF
	   [ CHAR A CHAR a - ] LITERAL +    THEN THEN THEN
   [CHAR] ! - CELLS 3§ÈÆA>–eãi∏a + @
   DUP 0FF AND SWAP 8 RSHIFT ;

\ 3§ÈØ¢ ∏aÃe ¨w»Å
\  0 : µw¢Ö ∑≥ùb
\  1 : –eãi∑≥ùb Ø°∏b
\  2 : ¡°¨˜ ∑≥ùb
\  3 : ¡°¨˜+∫ó¨˜ ∑≥ùb ( ¡°¨˜µA ¿Å∂ë ãi∏aï° –·∂w )
\  4 : ¡°¨˜+âs∫ó¨˜ ∑≥ùb ( ¡°¨˜µA ¿Å∂ë ãi∏aï° –·∂w )
\  5 : ¡°¨˜+∫ó¨˜+§h√± ∑≥ùb
\  6 : ¡°¨˜+∫ó¨˜+âs§h√± ∑≥ùb
6 ƒe µ°…°†a»a: >ãi∏a-3§ÈØ¢
\ ∑≥ùb|   êa†·ª°?  | –eµw§aéë?	|   ñıÆA?    |	   ¡°¨˜?    |	 ∫ó¨˜?	    |	§h√±?	   |
\ ¨w»Å--------------------------------------------------------------------------------------
 ( 0) | ãaê∑  | >0 | ¿Å∂ë! | >1 | ãaê∑ | >0  | ãaê∑    | >0 | ãaê∑    | >0  | ãaê∑     | >0
 ( 1) | ãaê∑  | >1 | ãaê∑  | >0 | ãaê∑ | >1  | ¡°¨˜!   | >2 | ∫ó¨˜!   | >3  | §h√±!    | >5
 ( 2) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | âs¡°¨˜? | >2 | ∫ó¨˜!   | >3  | §h√±!    | >5
 ( 3) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | µ≈+¡°   | >2 | âs∫ó¨˜? | >3? | §h√±!    | >5
 ( 4) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | µ≈+¡°   | >2 | µ≈+∫ó   | >3  | §h√±!    | >5
 ( 5) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | µ≈+¡°   | >2 | µ≈+∫ó   | >3  | âs§h√±?  | >5?
 ( 6) | µ≈+ch | >1 | µ≈¨˜  | >0 | ñ·ù° | >ñ· | µ≈+¡°   | >2 | µ≈+∫ó   | >3  | µ≈+§h√±  | >5
;µ°…°†a»a

' >ãi∏a-2§ÈØ¢         VALUE '>ãi∏a
' >ãiÆAàtâ¡π∑üA-2§ÈØ¢ VALUE '>ãiÆAàtâ¡π∑üA
: >ãi∏a 	  '>ãi∏a         EXECUTE ;
: >ãiÆAàtâ¡π∑üA   '>ãiÆAàtâ¡π∑üA EXECUTE ;

NONSTANDARD-WORDLIST SET-CURRENT
: 2BUL ( -- )
    ['] >ãi∏a-2§ÈØ¢         TO '>ãi∏a
    ['] >ãiÆAàtâ¡π∑üA-2§ÈØ¢ TO '>ãiÆAàtâ¡π∑üA ;
: 3BUL ( -- )
    ['] >ãi∏a-3§ÈØ¢         TO '>ãi∏a
    ['] >ãiÆAàtâ¡π∑üA-3§ÈØ¢ TO '>ãiÆAàtâ¡π∑üA ;
–eãi∑≥¬âùb-WORDLIST SET-CURRENT

: HEKEY
   ãiÆA…∑ @ ?DUP IF		\ ãiÆA…∑µA ãi∏aàa ∑∂∑a°e ãa ãi∏aüi •°êë
     DUP 0FF00 AND		\ ãiÆA…∑µA ñÅ ãi∏aàa ∑∂∑a°e ∂· 8 ß°Àaüi •°êë
     IF DUP 8 RSHIFT
	SWAP 0FF AND
	ãiÆA…∑ ! EXIT THEN
     0 ãiÆA…∑ ! EXIT  THEN	\ ãiÆA…∑∑Å –e ãi∏aüi •°êë
   £°µ≈¨˜∏a @  ¿Å∂ë∏a  <>  ãiÆA∑≥ùb¨w»Å @  AND	IF  £°µ≈¨˜∏a•°µa  THEN
   BEGIN  BEGIN PAUSE RX? UNTIL  RX@  >ãiÆAàtâ¡π∑üA  >ãi∏a  ?DUP UNTIL
	\ BEGIN ... UNTIL ∑i ®aπa êaµ© òÅ î·£°µA êq∑e àt∑e
	\   8 ß°Àa : –e ãi∏a : ãaê∑
	\  16 ß°Àa : ñÅ ãi∏a : µ≈¨˜ , µ≈+¡° , µ≈+¡°∫ó , ...
	\  16 ß°Àa : ≠A ãi∏a : µ≈¨˜+ch ( char àt∑e ãiÆA…∑ µA ói¥· ∑∂∑q )
   DUP 0FF00 AND IF		\ 16ß°Àa –eãi∏a∑°°e êa†·ª° ãi∏aüi ãiÆA…∑µA îq∑q
     DUP 8 RSHIFT SWAP 0FF AND	\ î·£°: ∂·8ß°Àa ¥aúÅ8ß°Àa
     ãiÆA…∑ @ ?DUP IF		\ î·£°: ∂·8ß°Àa ¥aúÅ8ß°Àa char
       SWAP 8 LSHIFT OR THEN
     ãiÆA…∑ !
   THEN ;

: HEKEY?
    £°µ≈¨˜∏a @ ¿Å∂ë∏a <> ãiÆA…∑ @ OR IF -1 ELSE RX? THEN ;

: SET-TEXT-I/O	( -- )
    ['] RX? TO 'ekey?
    ['] RX@ TO 'ekey
    ['] TX! TO 'emit ;

: SET-HGRAPHIC-I/O
    ['] HEKEY? TO 'ekey?
    ['] HEKEY  TO 'ekey
    ['] HEMIT  TO 'emit ;

NONSTANDARD-WORDLIST SET-CURRENT

DECIMAL VARIABLE åq§b∑±
0 60 CELLS 60 CELLS HAT multiI/O  multiI/O BUILD
0 60 CELLS 60 CELLS HAT HCURSOR   HCURSOR BUILD

: TEXT
    textmode# SET-MODE
    SET-TEXT-I/O
    0 TO GRAPHIC?
    multiI/O SLEEP  HCURSOR SLEEP ;

HEX
CODE ReadClockCount  ( -- ud )
    BX PUSH,
    AX AX XOR,	\ MOV AH,00
    1A INT,
    DX PUSH,
    CX BX MOV,
    NEXT,
END-CODE

DECIMAL
: åq§b∑±π°∏È  ( -- )
    ReadClockCount
    BEGIN 2DUP DNEGATE ReadClockCount D+ DROP UNTIL 2DROP
    ReadClockCount
    -1 0 DO PAUSE 0 0 BL EFONT! 0 0 BL EFONT!
	    2DUP DNEGATE ReadClockCount D+ DROP
	    IF 2DROP I åq§b∑± ! UNLOOP EXIT THEN LOOP
    2DROP -1 åq§b∑± ! ;

: HGRAPHIC
    VGA? IF
	3 TO textmode#
	['] VGA-SET-GRAPHIC TO 'SET-GRAPHIC
	VGA-Y>SegTable Y>SegTable !
	30 TO MAX-Y		\ 640X480 –Å¨wï°; 480 / 16 = 30 ∫â
    ELSE HERC? IF
	7 TO textmode#
	['] HERC-SET-GRAPHIC TO 'SET-GRAPHIC
	HERC-Y>SegTable Y>SegTable !
	25 TO MAX-Y		\ 640X400 –Å¨wï°; 400 / 16 = 25 ∫â
	MAX-Y 0 DO 1 MAX-X* 0 DO I J BL EFONT! LOOP LOOP
    ELSE SET-TEXT-I/O  0 TO GRAPHIC?
	 ." Korean characters can be displayed only on VGA or Hercules Graphics screen."
	 multiI/O SLEEP HCURSOR SLEEP EXIT
    THEN THEN
    VSCREEN VSCREEN-SIZE CHARS BL FILL
    SET-GRAPHIC
    0 HCHAR !
    0 ãiÆA∑≥ùb¨w»Å !
    0 ãiÆA…∑ !
    ¿Å∂ë!
    0 VSCR0 !
    0 YY !  0 VIR_Y !
    0 XX !  0 VIR_X !
    SET-HGRAPHIC-I/O
    multiI/O AWAKE  HCURSOR SLEEP  åq§b∑±π°∏È  HCURSOR AWAKE ;

–eãi∑≥¬âùb-WORDLIST SET-CURRENT

: NEW-SET-I/O
    GRAPHIC? IF SET-HGRAPHIC-I/O ELSE SET-TEXT-I/O THEN ;

HEX
: NEW-hi
    DOSCommand>PAD
    GET-MODE TO OldMode# HGRAPHIC hi
    ." ∑Åâeâ¡ πA¥eâ¡ ß°Õw∑i ∂· ∑•»·ëU ∫Å≠°êa –a∑°…I wykohù° •°êÅ ∫ÅØ≥Ø°µ°." CR
    S" BLOCKS.BLK" MAPPED-TO-BLOCK  QUIT ;

' NEW-SET-I/O TO 'init-i/o
' NEW-hi TO 'boot

: XX+!	( n -- )
   XX @ + MAX-X /MOD YY +! XX ! ;

FALSE VALUE SCREEN-UPDATED?

HEX
:NONAME multiI/O ACTIVATE
	BEGIN
	   PAUSE
	   YY @ MAX-X* XX @ + DUP VIR_Y @ MAX-X* VIR_X @ + <	IF
	      FALSE TO SCREEN-UPDATED?
	      YY @ VIR_Y @ < IF YY @ 1+ MAX-X*
			     ELSE VIR_Y @ MAX-X* VIR_X @ + THEN
	      SWAP
	      BEGIN DUP >VSCR-ADDR C@
		    DUP 80 <				IF
			 XX @ YY @ ROT EFONT! 1 XX+!	ELSE
			 8 LSHIFT >R
			 CHAR+ DUP >VSCR-ADDR C@ R> OR
			 XX @ YY @ ROT HFONT! 2 XX+!	THEN
	      CHAR+ 2DUP > 0= UNTIL 2DROP			ELSE
	      TRUE TO SCREEN-UPDATED?
	      DROP VIR_X @ XX ! VIR_Y @ YY !			THEN
	AGAIN
; EXECUTE

:NONAME HCURSOR ACTIVATE
	BEGIN
	  åq§b∑± @ 0 DO PAUSE LOOP
	  SCREEN-UPDATED?				    IF
	    GRAPHIC?					IF
		ãiÆA∑≥ùb¨w»Å @	?DUP		   IF
		    1-			  IF
		    £°µ≈¨˜∏a•°µa	  ELSE
		    XX @ YY @ [CHAR] _ EFONT! THEN ELSE
		    XX @ YY @ [CHAR] - EFONT!	   THEN THEN
	    åq§b∑± @ 0 DO PAUSE LOOP
	    GRAPHIC?				   IF
		XX @ YY @ BL EFONT!
		ãiÆA∑≥ùb¨w»Å @		      IF
		    XX @ CHAR+ YY @ BL EFONT! THEN THEN     THEN
	AGAIN
; EXECUTE

–eãi∑≥¬âùb-WORDLIST SET-CURRENT

HEX
CODE textAT-XY	( column row -- )
    2 # AH MOV,
    DX POP,
    BL DH MOV,
    BX BX XOR,
    10 INT,
    BX POP,
    NEXT,
END-CODE

FORTH-WORDLIST SET-CURRENT

\   AT-XY	( u1 u2 -- )			\ FACILITY
\		Perform implementation-dependent steps so that the next
\		character displayed will appear in column u1, row u2 of the
\		user output device, the upper left corner of which is column
\		zero, row zero.  An ambiguous condition exists if the
\		operation cannot be performed on the user output Adevice
\		with the specified parameters.
: AT-XY
   GRAPHIC? IF DUP YY ! VIR_Y ! DUP XX ! VIR_X !
   ELSE textAT-XY THEN ;

\   PAGE	( -- )				\ FACILITY
\		Move to another page for output. Actual function depends on
\		the output device.  On a terminal, PAGE clears the screen
\		and resets the cursor position to the upper left corner. On
\		a printer, PAGE performs a form feed.
DECIMAL
: PAGE
    GRAPHIC? IF MAX-Y 0 DO 1 MAX-X* 0 DO
		    BL J MAX-X* I + >VSCR-ADDR C!  I J BL EFONT!
		LOOP LOOP
		0 TO YTop
    ELSE 0 0 AT-XY 25 0 DO 80 0 DO BL EMIT LOOP LOOP
    THEN 0 0 AT-XY ;

: BYE	OldMode# SET-MODE  BYE ;

HGRAPHIC

SET-CURRENT  SET-ORDER
BASE !
